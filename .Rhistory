reg_fun <- lm(formula = df$Emissions ~df$year)
slope <-round(coef(reg_fun)[2], 2)
if (slope < 0) {emission_status <- "Decreased"}
if (slope == 0) {emission_status <- "Unchanges"}
if (slope > 0) {emission_status <- "Increased"}
c(slope,emission_status)
}
regressions_data<- ddply(data_compare_fips,"fips",regression)
colnames(regressions_data)<- c("fips","slope","status")
regressions_data$slope <- as.numeric(regressions_data$slope)
for(i in 1:2){
if(regressions_data$slope[i] ==min(regressions_data$slope) & regressions_data$slope[i] <0){regressions_data$MinMax[i] <- "Maximum"}
else if(regressions_data$slope[i] ==max(regressions_data$slope) & regressions_data$slope[i] <0){regressions_data$MinMax[i] <- "Minimum"}
else if(regressions_data$slope[i] ==min(regressions_data$slope) & regressions_data$slope[i] >0){regressions_data$MinMax[i] <- "Minimim"}
else if(regressions_data$slope[i] ==max(regressions_data$slope) & regressions_data$slope[i] >0){regressions_data$MinMax[i] <- "Maximum"}
else{ regressions_data$MinMax[i] <- ""}
}
p1 <-ggplot(data_compare_fips,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~fips)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1600,label=paste("Slope of Liner Regression Line=",slope,",Emission Status:",status))) + ggtitle("Comparison of Emission from Motor Vehicles between Baltimore City & California from 1999-2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa (California(fips=06037) & Baltimore City(fips=24510))")
regression <- function(df) {
reg_fun <- lm(formula = df$Emissions ~df$year)
slope <-round(coef(reg_fun)[2], 2)
if (slope < 0) {emission_status <- "Decreased"}
if (slope == 0) {emission_status <- "Unchanges"}
if (slope > 0) {emission_status <- "Increased"}
c(slope,emission_status)
}
regressions_data<- ddply(data_compare_fips,"fips",regression)
colnames(regressions_data)<- c("fips","slope","status")
regressions_data$slope <- as.numeric(regressions_data$slope)
p1 <-ggplot(data_compare_fips,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~fips)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1600,label=paste("Slope of Liner Regression Line=",slope,",Emission Status:",status))) + ggtitle("Comparison of Emission from Motor Vehicles between Baltimore City & California from 1999-2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa (California(fips=06037) & Baltimore City(fips=24510))")
library(dplyr)
library(lattice)
library(ggplot2)
library(stringr)
library(outliers)
library(RColorBrewer)
library(plyr)
#downloading the file :
#setwd("C:/Users/abhishek.katyal/Documents/ds")
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data")
url <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
if(!file.exists("C:/Users/Portal X/Documents/Data Science Coursera/data/pollution.zip")){
download.file(url, destfile = "C:/Users/abhishek.katyal/Documents/ds/pollution.zip")
}
unzip("pollution.zip")
#loading the data into a R object :
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
#Merging the two above data frame :
NEI$SCC <- as.factor(NEI$SCC)
data_set <- merge(NEI,SCC, by ="SCC",all.x = TRUE)
new_data <-arrange(data_set,desc(Emissions))
#Plot 1:
###################################################################
new_data_grouped <- group_by(new_data,year)
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Pollution over the Years",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = data_mean )
abline(model,lty = 4)
class(new_data_grouped$year)
class(data_mean$year)
class(data_mean$Emissions)
coef(model)
points(model,lty = 4)
new_data_grouped <- group_by(new_data,year)
data_mean <- summarise_each(new_data_grouped,funs = "mean")
plot(new_data_grouped$Emissions,new_data_grouped$year, main = "Decline in Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = new_data_grouped$year,col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = data_mean )
1 +1
new_data_grouped$year <- as.factor(as.character(new_data_grouped$year))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = new_data_grouped$year,col=brewer.pal(4,"Spectral"))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)",col=brewer.pal(4,"Spectral"))
1 + 1
?plot
model <- lm(year~Emissions,data = new_data )
points(model,lty = 4)
abline(model,lty = 4)
abline(model,lty = 6)
xyplot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)",col=brewer.pal(4,"Spectral"))
new_data_grouped <- group_by(new_data,year)
xyplot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)",col=brewer.pal(4,"Spectral"))
abline(model,lty = 6 , col = "red")
new_data_grouped <- group_by(new_data,year)
#data_mean <- summarise_each(new_data_grouped,funs = "mean")
new_data_grouped$year <- as.factor(as.character(new_data_grouped$year))
xyplot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Mean Of Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
1+1
new_data_grouped$year <- as.factor(as.character(new_data_grouped$year))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
?plot
coef()
coef(model)
coef(model)[2]
round(coef(model)[2],3)
round(coef(model)[2],6)
round(coef(model)[2],5)
round(coef(model)[2],3)
round(coef(model)[2],4)
coef(model)[2]
as.numeric(coef(model)[2])
as.integer(coef(model)[2])
coef(model)[2]
mtext("The Slope of linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission")
1+1
new_data_grouped$year <- as.factor(as.character(new_data_grouped$year))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"),ylim= c(0,2e+05))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
?par
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
dir()
getwd()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png")
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/power/graph")
dev.off()
Maryland_data <- subset.data.frame(new_data,new_data$fips == "24510")
Maryland_data$year <- as.factor(as.character(Maryland_data$year))
Maryland_data <- group_by(Maryland_data,year)
Maryland_data_mean <- summarise_each(Maryland_data,funs = "mean")
par(mfrow = C(1,2))
plot(Maryland_data$year,Maryland_data$Emissions, ylim = c(0,5),col=brewer.pal(4,"Spectral"))
model2 <- lm(mean(Emissions)~year,data = Maryland_data )
abline(model2,lty = 3,col = "red")
barplot(Maryland_data_mean$year,Maryland_data_mean$Emissions,col=brewer.pal(4,"Spectral"))
barplot(Maryland_data_mean$Emissions,Maryland_data_mean$year,col=brewer.pal(4,"Spectral"))
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png", bg="transparent",width = 800,height = 800,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/power/graph")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png",width = 1200,height = 1200,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/power/graph")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png",width = 1600,height = 1200,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/power/graph")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png",width = 1600,height = 1600,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/power/graph")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1600,res = 120)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
Maryland_data$year <- as.numeric(as.character(Maryland_data$year))
Maryland_data_type <- group_by(Maryland_data,year,type)
Maryland_data_type_model <- group_by(Maryland_data,type)
regression <- function(df) {
reg_fun <- lm(formula = df$Emissions ~df$year)
slope <-round(coef(reg_fun)[2], 2)
if (slope < 0) {emission_status <- "Decreased"}
if (slope == 0) {emission_status <- "Unchanges"}
if (slope > 0) {emission_status <- "Increased"}
c(slope,emission_status)
}
regressions_data<- ddply(Maryland_data_type_model,"type",regression)
colnames(regressions_data)<- c("type","slope","status")
regressions_data$slope <- as.numeric(regressions_data$slope)
for(i in 1:4){
if(regressions_data$slope[i] ==min(regressions_data$slope) & regressions_data$slope[i] <0){regressions_data$MinMax[i] <- "Maximum"}
else if(regressions_data$slope[i] ==max(regressions_data$slope) & regressions_data$slope[i] <0){regressions_data$MinMax[i] <- "Minimum"}
else if(regressions_data$slope[i] ==min(regressions_data$slope) & regressions_data$slope[i] >0){regressions_data$MinMax[i] <- "Minimim"}
else if(regressions_data$slope[i] ==max(regressions_data$slope) & regressions_data$slope[i] >0){regressions_data$MinMax[i] <- "Maximum"}
else{ regressions_data$MinMax[i] <- ""}
}
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1600,res = 120)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png",width = 1900,height = 1600,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot1.png",width = 1600,height = 1600,res = 120)
par(mfrow = c(2,1))
plot(new_data_grouped$year,new_data_grouped$Emissions, main = "Decline in Emission from 1999-2008 from all Sources",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model <- lm(year~Emissions,data = new_data )
abline(model,lty = 6 , col = "red")
mtext("The Slope of Red linear regression line is = -6.533314e-05 , a negative slope indicated decrease in Emission from 1999-2008")
data_mean <- summarise_each(new_data_grouped,funs = "mean")
barplot(data_mean$Emissions,data_mean$year, main = "Decline in Mean of Emission from 1999-2008",xlab = "Years",ylab = "Mean Of Emission(In Tons)", names = data_mean$year,col=brewer.pal(4,"Spectral"))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1200,res = 120)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1900,height = 1000,res = 120)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 2500,height = 1000,res = 320)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 2000,height = 1000,res = 320)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1200,res = 320)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1200,res = 70)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1600,height = 1200,res = 100)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 72)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 150)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 120)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 110)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot3.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(Maryland_data_type,aes(x = year,y = Emissions, color = type,label = Maryland_data_type$fips))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~type)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status for Source",type, ":",status,MinMax))) + ggtitle("Change in Emission of Baltimore City for different Source Types from 1999 to 2008",subtitle = "Negative Slope of Linear Regeression line(blue) indicates Decrease in Emission from 1999-2008 and/or vice versa")
dev.off()
data_coal <- filter(data_set,grepl("coal",EI.Sector,ignore.case = TRUE))
model <- lm(data_coal$Emissions ~ data_coal$year)
slope <- round(coef(model)[2],3)
if(slope < 0){
status <- "Decreased"
}
if(slope >0){
status <- "Increased"
}
slope_status <- cbind.data.frame(slope,status)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
data_coal <- filter(data_set,grepl("coal",EI.Sector,ignore.case = TRUE))
model <- lm(data_coal$Emissions ~ data_coal$year)
slope <- round(coef(model)[2],3)
if(slope < 0){
status <- "Decreased"
}
if(slope >0){
status <- "Increased"
}
slope_status <- cbind.data.frame(slope,status)
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot4.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot4.png",width = 1800,height = 1200,res = 150)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression line(in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot4.png",width = 1000,height = 1000,res = 100)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression line(in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot4.png",width = 1600,height = 1200,res = 100)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression line(in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot4.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_coal,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions from Coal Combustion- related sources from 1999-2008 Across United States", subtitle = "Negative Slope of Linear Regeression line(in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 15000,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
data_baltimore_motor <- filter(data_set,data_set$fips == "24510")
data_baltimore_motor <- filter(data_baltimore_motor,grepl("Vehicle",data_baltimore_motor$SCC.Level.Two))
model <- lm(data_baltimore_motor$Emissions ~ data_baltimore_motor$year)
slope <- round(coef(model)[2],3)
if(slope < 0){
status <- "Decreased"
}
if(slope >0){
status <- "Increased"
}
slope_status <- cbind.data.frame(slope,status)
p1 <-ggplot(data_baltimore_motor,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions for Motor Vehicles- related sources from 1999-2008 in Baltimore City", subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 50,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot5.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_baltimore_motor,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions for Motor Vehicles- related sources from 1999-2008 in Baltimore City", subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 50,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot5.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_baltimore_motor,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions for Motor Vehicles- related sources from 1999-2008 in Baltimore City", subtitle = "Negative Slope of Linear Regeression line (in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 50,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
data_compare <- filter(data_set,data_set$fips == "24510" |  data_set$fips == "06037")
data_compare <- filter(data_compare,grepl("Vehicle",data_compare$SCC.Level.Two))
data_compare_fips <- group_by(data_compare,fips)
data_compare_fips$fips <- gsub("06037","Los Angeles County, California",data_compare_fips$fips)
data_compare_fips$fips <- gsub("24510","Baltimore City, Maryland",data_compare_fips$fips)
regression <- function(df) {
reg_fun <- lm(formula = df$Emissions ~df$year)
slope <-round(coef(reg_fun)[2], 2)
if (slope < 0) {emission_status <- "Decreased"}
if (slope == 0) {emission_status <- "Unchanges"}
if (slope > 0) {emission_status <- "Increased"}
c(slope,emission_status)
}
regressions_data<- ddply(data_compare_fips,"fips",regression)
colnames(regressions_data)<- c("fips","slope","status")
regressions_data$slope <- as.numeric(regressions_data$slope)
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot5.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_compare_fips,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~fips)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1600,label=paste("Slope of Liner Regression Line=",slope,",Emission Status:",status))) + ggtitle("Comparison of Emission from Motor Vehicles between Baltimore City & California from 1999-2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa (California(fips=06037) & Baltimore City(fips=24510))")
dev.off()
data_compare <- filter(data_set,data_set$fips == "24510" |  data_set$fips == "06037")
data_compare <- filter(data_compare,grepl("Vehicle",data_compare$SCC.Level.Two))
data_compare_fips <- group_by(data_compare,fips)
data_compare_fips$fips <- gsub("06037","Los Angeles County, California",data_compare_fips$fips)
data_compare_fips$fips <- gsub("24510","Baltimore City, Maryland",data_compare_fips$fips)
regression <- function(df) {
reg_fun <- lm(formula = df$Emissions ~df$year)
slope <-round(coef(reg_fun)[2], 2)
if (slope < 0) {emission_status <- "Decreased"}
if (slope == 0) {emission_status <- "Unchanges"}
if (slope > 0) {emission_status <- "Increased"}
c(slope,emission_status)
}
regressions_data<- ddply(data_compare_fips,"fips",regression)
colnames(regressions_data)<- c("fips","slope","status")
regressions_data$slope <- as.numeric(regressions_data$slope)
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot6.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_compare_fips,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~fips)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1600,label=paste("Slope of Liner Regression Line=",slope,",Emission Status:",status))) + ggtitle("Comparison of Emission from Motor Vehicles between Baltimore City & California from 1999-2008",subtitle = "Negative Slope of Linear Regeression indicates Decrease in Emission from 1999-2008 and/or vice versa (California(fips=06037) & Baltimore City(fips=24510))")
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot5.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_baltimore_motor,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions for Motor Vehicles- related sources from 1999-2008 in Baltimore City", subtitle = "Negative Slope of Linear Regeression line (in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 50,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot5.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_baltimore_motor,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 1,lty = 5, se=TRUE, color="blue")
p1 + ggtitle("Change in Emissions for Motor Vehicles- related sources from 1999-2008 in Baltimore City", subtitle = "Negative Slope of Linear Regeression line (in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa") +  geom_label(data= slope_status, inherit.aes=FALSE, aes(y = 50,x = 2000,label=paste("Slope of Linear Regression Line=",slope,",Emission Status:",status)))
dev.off()
png()
setwd("C:/Users/Portal X/Documents/Data Science Coursera/data/Emission")
png(filename = "plot6.png",width = 1800,height = 1200,res = 100)
p1 <-ggplot(data_compare_fips,aes(x = year,y = Emissions, color = type))+ geom_point()+geom_smooth(method="lm",lwd = 0.3,lty = 5, se=TRUE, color="blue")
p1 + facet_wrap(~fips)  +  geom_label(data= regressions_data, inherit.aes=FALSE, aes(x = 2004, y = 1600,label=paste("Slope of Liner Regression Line=",slope,",Emission Status:",status))) + ggtitle("Comparison of Emission from Motor Vehicles between Baltimore City & California from 1999-2008",subtitle = "Negative Slope of Linear Regeression line (in blue) indicates Decrease in Emission from 1999-2008 and/or vice versa (California(fips=06037) & Baltimore City(fips=24510))")
dev.off()
barplot(Maryland_data_mean$Emissions,Maryland_data_mean$year,col=brewer.pal(4,"Spectral"))
barplot(Maryland_data_mean$year,Maryland_data_mean$Emissions,col=brewer.pal(4,"Spectral"))
plot(Maryland_data$year,Maryland_data$Emissions, ylim = c(0,5),col=brewer.pal(4,"Spectral"))
model2 <- lm(Emissions~year,data = Maryland_data )
abline(model2,lty = 3,col = "red")
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
plot(Maryland_data$year,Maryland_data$Emissions,main = "Decline in Emission from 1999-2008 from all Sources for Baltimore City",xlab = "Years",ylab = "Emission(In Tons)",col=brewer.pal(4,"Spectral"))
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
barplot(Maryland_data_mean$year,Maryland_data_mean$Emissions,col=brewer.pal(4,"Spectral"))
Maryland_data$year <- as.numeric(as.character(Maryland_data$year))
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
Maryland_data <- subset.data.frame(new_data,new_data$fips == "24510")
Maryland_data$year <- as.factor(as.character(Maryland_data$year))
Maryland_data <- group_by(Maryland_data,year)
Maryland_data_mean <- summarise_each(Maryland_data,funs = "mean")
#par(mfrow = C(1,2))
plot(Maryland_data$year,Maryland_data$Emissions,main = "Decline in Emission from 1999-2008 from all Sources for Baltimore City",xlab = "Years",ylab = "Emission(In Tons)")
Maryland_data$year <- as.numeric(as.character(Maryland_data$year))
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
barplot(Maryland_data_mean$year,Maryland_data_mean$Emissions,col=brewer.pal(4,"Spectral"))
Maryland_data <- subset.data.frame(new_data,new_data$fips == "24510")
Maryland_data$year <- as.factor(as.character(Maryland_data$year))
Maryland_data <- group_by(Maryland_data,year)
Maryland_data_mean <- summarise_each(Maryland_data,funs = "mean")
#par(mfrow = C(1,2))
plot(Maryland_data$year,Maryland_data$Emissions,main = "Decline in Emission from 1999-2008 from all Sources for Baltimore City",xlab = "Years",ylab = "Emission(In Tons)")
Maryland_data$year <- as.numeric(as.character(Maryland_data$year))
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
Maryland_data <- subset.data.frame(new_data,new_data$fips == "24510")
Maryland_data$year <- as.factor(as.character(Maryland_data$year))
Maryland_data <- group_by(Maryland_data,year)
Maryland_data_mean <- summarise_each(Maryland_data,funs = "mean")
#par(mfrow = C(1,2))
plot(Maryland_data$year,Maryland_data$Emissions,main = "Decline in Emission from 1999-2008 from all Sources for Baltimore City",xlab = "Years",ylab = "Emission(In Tons)")
Maryland_data$year <- as.numeric(as.character(Maryland_data$year))
model2 <- lm(year~Emissions,data = Maryland_data )
abline(model2,lty = 3,col = "red")
plot(Maryland_data$year,Maryland_data$Emissions,main = "Decline in Emission from 1999-2008 from all Sources for Baltimore City",xlab = "Years",ylab = "Emission(In Tons)")
